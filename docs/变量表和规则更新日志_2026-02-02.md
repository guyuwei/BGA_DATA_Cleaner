# 变量表和规则更新日志

记录数据清洗、列名标准化、规则与变量表（rules.yaml / variables.yaml）的变更与流水线说明。文末为 Health / HYPO 列名对照表，请勿删除。

---

## 已完成事项

### 原始文件合并与筛选

34 个原始文件合并为批次文件；基线表信息包含于入院记录且缺失住院时间段，已丢弃。执行结果摘要如下：

```text
Health 组: 13 个文件
  ✓ 基线数据.test_全部诊断.csv
  ✓ 基线数据.test_药品类医嘱.csv
  ✓ 基线数据.test_非药品类医嘱.csv
  ✓ 基线数据.test_血糖单.csv
  ✓ 基线数据.test_生化检查.csv
  ✓ 基线数据.test_血常规.csv
  ✓ 基线数据.test_C反应蛋白检测.csv
  ✓ 基线数据.test_糖代谢测定.csv
  ✓ 基线数据.test_入院记录.csv
  ✓ 基线数据.test_生命体征.csv
  ✓ 基线数据.test_住院.csv
  ✓ 基线数据.test_其他检验.csv
  - 基线数据.test.csv (基线表，已丢弃)
HYPO 组: 13 个文件
  ✓ 基线数据.低血糖_其他检验.csv
  ✓ 基线数据.低血糖_全部诊断.csv
  ✓ 基线数据.低血糖_药品类医嘱.csv
  ✓ 基线数据.低血糖_非药品类医嘱.csv
  ✓ 基线数据.低血糖_血糖单.csv
  ✓ 基线数据.低血糖_生化检查.csv
  ✓ 基线数据.低血糖_血常规.csv
  ✓ 基线数据.低血糖_C反应蛋白检测.csv
  ✓ 基线数据.低血糖_糖代谢测定.csv
  ✓ 基线数据.低血糖_入院记录.csv
  ✓ 基线数据.低血糖_生命体征.csv
  ✓ 基线数据.低血糖_住院.csv
  - 基线数据.低血糖.csv (基线表，已丢弃)

# 基线数据 VS 根据ID去重后的入院记录
❌ 基线数据.test.csv
基线表 - test_gender_time_quantum1:
  男	: 6,772
  女	: 5,464
  总计: 12,236
入院记录表 - test_gender_time_quantum1:
  男	: 6,772
  女	: 5,464
  总计: 12,236
  缺失值: 0

基线表 - test_death_time_quantum1:
  否	: 12,221
  是	: 15
入院记录表 - test_death_time_quantum1:
  否	: 12,221
  是	: 15
❌ 基线数据.低血糖.csv
死亡分布对比:
  ✓ 否	: 基线表=12,221, 入院记录=12,221, 差异=0
  ✓ 是	: 基线表=15, 入院记录=15, 差异=0
性别分布对比:
  ✓ 男	: 基线表=6,772, 入院记录=6,772, 差异=0
  ✓ 女	: 基线表=5,464, 入院记录=5,464, 差异=0
共同患者数: 1,618



  - 基线数据.test.csv → 已移动到备份
  - 基线数据.低血糖.csv → 已移动到备份
  - 分别 12 个文件
```

### 各子表结构标准化

| 原文件名                        | 新文件名       | 说明          |
| :------------------------------ | :------------- | :------------ |
| 基线数据.test_全部诊断.csv      | 诊断.csv       | 全部诊断记录  |
| 基线数据.test_药品类医嘱.csv    | 药品医嘱.csv   | 药品类医嘱    |
| 基线数据.test_非药品类医嘱.csv  | 非药品医嘱.csv | 非药品类医嘱  |
| 基线数据.test_血糖单.csv        | 血糖.csv       | 血糖单记录    |
| 基线数据.test_生化检查.csv      | 生化.csv       | 生化检查      |
| 基线数据.test_血常规.csv        | 血常规.csv     | 血常规检查    |
| 基线数据.test_C反应蛋白检测.csv | CRP.csv        | C反应蛋白检测 |
| 基线数据.test_糖代谢测定.csv    | 糖代谢.csv     | 糖代谢测定    |
| 基线数据.test_入院记录.csv      | 入院记录.csv   | 入院记录      |
| 基线数据.test_生命体征.csv      | 生命体征.csv   | 生命体征      |
| 基线数据.test_住院.csv          | 住院.csv       | 住院信息      |
| 基线数据.test_其他检验.csv      | 其他检验.csv   | 其他检验      |

子文件表头标准化规则：

1. 添加 `admission_key = patient_sn + '_' + time_quantum`
2. 删除 `patient_sn`、`time_quantum`、`group_name` 列
3. 删除中文列名行，只保留英文列名
4. 将 `admission_key` 移至第一列

### Study Cohort 筛选（步骤 2）

- 排除患者：按诊断、科室规则排除
- 整理列结构

执行输出摘要：

```text
步骤2：Study Cohort 筛选

【诊断排除】Health
  总患者数: 367,080
  '妊娠糖尿病': 9 个患者
  '死亡': 6 个患者
  小计: 15 个患者

【科室排除】Health
  小计: 72 个患者

============================================================
Health 组排除汇总:
  诊断排除: 15
  科室排除: 72
  总排除: 86
============================================================

【删除记录】从 Health 组所有文件中排除 86 个患者
  CRP.csv: 381,804 → 381,473 (删除 331)
  住院.csv: 367,081 → 366,995 (删除 86)
  入院记录.csv: 367,080 → 366,994 (删除 86)
  其他检验.csv: 1,468,375 → 1,468,031 (删除 344)
  生化.csv: 686,793 → 683,684 (删除 3,109)
  生命体征.csv: 513,371 → 512,373 (删除 998)
  糖代谢.csv: 367,137 → 367,051 (删除 86)
  药品医嘱.csv: 1,882,247 → 1,871,751 (删除 10,496)
  血常规.csv: 480,248 → 478,916 (删除 1,332)
  血糖.csv: 701,693 → 698,866 (删除 2,827)
  诊断.csv: 1,258,878 → 1,253,604 (删除 5,274)
  非药品医嘱.csv: 1,242,414 → 1,235,386 (删除 7,028)

✓ Health 组共删除 31,997 条记录

================================================================================
HYPO 组
================================================================================

【诊断排除】HYPO
  总患者数: 42,068
  '死亡': 3 个患者
  小计: 3 个患者

【科室排除】HYPO
  小计: 209 个患者

============================================================
HYPO 组排除汇总:
  诊断排除: 3
  科室排除: 209
  总排除: 210
============================================================

【删除记录】从 HYPO 组所有文件中排除 210 个患者
  CRP.csv: 46,876 → 45,203 (删除 1,673)
  住院.csv: 42,068 → 41,858 (删除 210)
  入院记录.csv: 42,068 → 41,858 (删除 210)
  其他检验.csv: 168,293 → 167,453 (删除 840)
  生化.csv: 108,552 → 96,391 (删除 12,161)
  生命体征.csv: 78,427 → 74,393 (删除 4,034)
  糖代谢.csv: 42,079 → 41,866 (删除 213)
  药品医嘱.csv: 407,629 → 332,493 (删除 75,136)
  血常规.csv: 72,070 → 64,753 (删除 7,317)
  血糖.csv: 153,158 → 133,064 (删除 20,094)
  诊断.csv: 233,963 → 204,432 (删除 29,531)
  非药品医嘱.csv: 240,352 → 199,286 (删除 41,066)
```

### 药品类医嘱降糖药物方案（11 种）

**口服降糖药（7 类）**

| 药物分类 | data_in_ehr                 | 特殊规则                               |
| -------- | --------------------------- | -------------------------------------- |
| 二甲双胍 | K列药物成分名，关键词匹配   | -                                      |
| 磺脲类   | K列药物成分名，关键词匹配   | -                                      |
| 格列奈类 | K列药物成分名，关键词匹配   | -                                      |
| TZDs     | K列药物成分名，关键词匹配   | -                                      |
| AGIs     | K列药物成分名，关键词匹配   | -                                      |
| DPP-4i   | K列药物成分名，关键词匹配   | -                                      |
| SGLT2i   | K列药物成分名+J列药物商品名 | ✨ 特例：J列=艾托格列净(捷诺妥)且K列=NA |

**胰岛素（4类）**:

| 药物分类   | data_in_ehr                             | 特殊规则                                               |
| ---------- | --------------------------------------- | ------------------------------------------------------ |
| 餐时胰岛素 | K列药物成分名+J列药物商品名+R列给药途径 | ✨ 特例：K=胰岛素+J=胰岛素注射液+R∈{皮下,皮内,肌肉注射} |
| 基础胰岛素 | K列药物成分名，关键词匹配               | -                                                      |
| 预混胰岛素 | K列药物成分名，关键词匹配               | -                                                      |
| 双胰岛素   | K列药物成分名+J列药物商品名             | ✨ 特例：K=胰岛素+J=德谷门冬双胰岛素(诺和佳（畅充）)    |

### 合并症变量（13 种 → 14 种）

| 变量名             | data_in_ehr | 匹配逻辑                                                     |
| ------------------ | ----------- | ------------------------------------------------------------ |
| 高血压             | E列诊断名称 | 包含"高血压"                                                 |
| 高脂血症           | E列诊断名称 | 包含"高脂血症"或"高胆固醇"或"甘油三酯"或"血脂异常"           |
| 冠心病             | E列诊断名称 | 包含"冠状动脉"或"冠心病"或"心肌梗死"或"心绞痛"               |
| 恶性肿瘤           | E列诊断名称 | 包含"恶性肿瘤"或"癌"或"肉瘤"或"白血病"或"淋巴瘤"             |
| 慢性肾衰竭         | E列诊断名称 | 包含"慢性肾衰"或"尿毒症"或"慢性肾脏病4期"或"慢性肾脏病5期"   |
| 肾脏替代治疗       | E列诊断名称 | 包含"透析"或"肾移植"                                         |
| 糖尿病周围血管病变 | E列诊断名称 | AND逻辑：包含"糖尿病"且包含"血管病"                          |
| 糖尿病周围神经病变 | E列诊断名称 | AND逻辑：包含"糖尿病"且包含"神经病"                          |
| 糖尿病足           | E列诊断名称 | AND逻辑：包含"糖尿病"且包含"足"                              |
| 糖尿病肾病         | E列诊断名称 | AND逻辑：包含"糖尿病"且包含"肾病"                            |
| 糖尿病视网膜病变   | E列诊断名称 | AND逻辑：包含"糖尿病"且包含"视网膜"                          |
| 1型糖尿病          | E列诊断名称 | 包含"1型糖尿病"或"I型糖尿病"                                 |
| **脑血管意外** ✨   | E列诊断名称 | 包含"脑卒中"或"脑血管意外"或"脑梗"或"脑出血"或"蛛网膜下腔出血"或"脑缺血" |

#### data_reference 字段

合并症与降糖药物变量的数据来源已统一为：

- 合并症：`Health/基线数据.test_全部诊断.csv` + `HYPO/基线数据.低血糖_全部诊断.csv`
- anonymization:
```yaml
note: "用户要求暂不执行匿名化，用于计算人数"

drop_column_patterns:
  - "住院号"
  - "vsn"
  - "vsn_*"
  - "IP|*"
  - "LZ|*"
  - "inpatient_no_id"

date_truncation:
  birth_date:
    keep: "year-month"
    format: "YYYY-MM"
  admission_date:
    keep: "year-month-day"
    format: "YYYY-MM-DD"

lab_files:
  birth_date_column: "D"
  drop_columns: ["G"]
  note: "检查文件通用脱敏：D列出生日期→年月，G列编号→整列删除"
```

---

## 流水线脚本（2026-02-03）

使用 `run_all.sh` 依次执行步骤 1～7（共 7 步）。**改时间（日期 8-8）已并入步骤 1，在 Study Cohort 前完成。**

| 顺序 | 脚本                     | 说明                              |
| ---- | ------------------------ | --------------------------------- |
| 1    | 步骤1_重新开始.py        | 重新开始 + 整理列 + 院区列(Campus) + 日期 8-8 转换 |
| 2    | 步骤2_StudyCohort筛选.py | Study Cohort 筛选                 |
| 3    | 步骤3_药物医嘱整理.py    | 药物医嘱整理                      |
| 4    | 步骤4_合并症提取.py      | 合并症提取                        |
| 5    | 步骤5_手术事件提取.py    | 手术事件提取                      |
| 6    | 步骤6_禁食营养提取.py    | 禁食营养提取                      |
| 7    | 步骤7_拼接时序大表.py    | 拼接时序大表（末尾打印大表 info） |



### 各步骤脚本 print 输出内容

运行 `run_all.sh` 或单独运行各步骤时，脚本会向标准输出打印如下内容（格式统一：`SEP`/`SUB` 分隔，子项缩进 2 空格）。

**步骤 1（步骤1_重新开始.py）**

- 标题：步骤1：重新开始 + 整理列 + 院区列 + 日期8-8 转换
- 步骤1a：清理旧数据；1b：并行合并文件；1c：构建 admission_key；1d：重命名文件；1e：整理列；**1e2：院区列（住院.csv 添加 Campus）**；1f：日期 8-8 规则转换（在 Study Cohort 前完成）
- 结束：总耗时及各阶段耗时，下一步提示

**步骤 2（步骤2_StudyCohort筛选.py）**

- 标题：步骤2：Study Cohort 筛选
- Health 组：诊断排除（总患者数、各关键词排除人数、小计）、科室排除（小计）、排除汇总、各文件删除记录行数（文件名: 原行数→新行数）
- HYPO 组：同上
- 结束：完成提示、下一步提示

**步骤 3（步骤3_药物医嘱整理.py）**

- 标题：步骤3：药物医嘱整理
- 各组：读取文件、原始记录数/患者数、已撤销医嘱数（若有）、有效医嘱数；口服降糖药/胰岛素各类别统计；输出文件与列说明
- 结束：修改的文件、新增列说明、下一步提示

**步骤 4（步骤4_合并症提取.py）**

- 标题：步骤4：合并症提取
- 各组：诊断记录数、唯一患者数；14 种合并症各变量名与患者数（及占比）、匹配诊断样例；合并症特征行数列数；有/无合并症患者数；合并到原文件后的行数列数
- 结束：修改的文件、新增 13 列名称与说明、变量说明文档、下一步提示

**步骤 5（步骤5_手术事件提取.py）**

- 标题：处理各组
- 各组：非药品医嘱行数列数、列映射、已撤销排除（若有）、手术记录数、日期提取成功数及示例、按患者聚合后的有/无手术患者数与占比、合并后行数列数、新增 2 列
- 结束：修改的文件、Surgery / Surgery_dates 说明、说明文档、下一步提示

**步骤 6（步骤6_禁食营养提取.py）**

- 各组：非药品医嘱记录数、禁食记录数及时间窗示例、营养记录数及示例、唯一患者数、有禁食/有营养患者数与占比、合并后行数列数、新增 4 列
- 结束：修改的文件、Fasting / Fasting_periods / Nutrition / Nutrition_periods 说明、说明文档、下一步提示

**步骤 7（步骤7_拼接时序大表.py）**

- 标题：步骤7：拼接时序预测大表；数据结构说明（每天一条、结局定义）
- 各组：血糖与次日结局统计、静态特征与院区分布、实验室/生命体征/用药特征、时序表行数、去掉首末天后行数、最终时序大表行数列数
- 合并：合并后总记录数、Health/HYPO 条数、总列数、次日结局分布（0/1/2 类数量与占比）
- 输出文件：BGA 三分类表、HYPO 二分类表路径与结局分布、缺失统计文件
- 结束：生成文件列表、数据特点、预测任务说明；**最后打印 BGA 三分类表与 HYPO 二分类表的 DataFrame.info()**

---

### CRP.csv（22 → 17）

| 序号 | 原来的列名                                            | 现在的列名                         |
| ---- | ----------------------------------------------------- | ---------------------------------- |
| A    | patient_sn                                            | admission_key                      |
| B    | 分组名称                                              | vsn_lab_crp_tests                  |
| C    | test_性别_时间段1                                     | CRP_test_time                      |
| D    | test_出生日期_时间段1                                 | CRP_pure_item_name                 |
| E    | test_是否死亡_时间段1                                 | CRP_item_name                      |
| F    | 时间段                                                | CRP_qualitative_result             |
| G    | vsn_C反应蛋白检测                                     | CRP_test_result                    |
| H    | C-反应蛋白(CRP)-静脉血_检验日期                       | hs-CRP_test_time                   |
| I    | C-反应蛋白(CRP)-静脉血_检验项目名称(原值)             | hs-CRP_pure_item_name              |
| J    | C-反应蛋白(CRP)-静脉血_检验项目名称(归一)             | hs-CRP_item_name                   |
| K    | C-反应蛋白(CRP)-静脉血_检验定性结果                   | hs-CRP_qualitative_result          |
| L    | C-反应蛋白(CRP)-静脉血_检验定量结果                   | hs-CRP_test_result                 |
| M    | 超敏C反应蛋白(hs-CRP)-静脉血_检验日期                 | hs-CRP_test_time.1                 |
| N    | 超敏C反应蛋白(hs-CRP)-静脉血_检验项目名称(原值)       | hs-CRP)-静脉血(空腹_pure_item_name |
| O    | 超敏C反应蛋白(hs-CRP)-静脉血_检验项目名称(归一)       | hs-CRP)-静脉血(空腹_item_name      |
| P    | 超敏C反应蛋白(hs-CRP)-静脉血_检验定性结果             | hs-CRP_qualitative_result.1        |
| Q    | 超敏C反应蛋白(hs-CRP)-静脉血_检验定量结果             | hs-CRP_test_result.1               |
| R    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验日期           | ❌ 删除                             |
| S    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验项目名称(原值) | ❌ 删除                             |
| T    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验项目名称(归一) | ❌ 删除                             |
| U    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验定性结果       | ❌ 删除                             |
| V    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验定量结果       | ❌ 删除                             |

---

### 住院.csv（16 → 11）

| 序号 | 原来的列名            | 现在的列名            |
| ---- | --------------------- | --------------------- |
| A    | patient_sn            | admission_key         |
| B    | 分组名称              | vsn_first_page_record |
| C    | test_性别_时间段1     | visit_date            |
| D    | test_出生日期_时间段1 | inpatient_no          |
| E    | test_是否死亡_时间段1 | visit_department      |
| F    | 时间段                | icd10_name            |
| G    | vsn_住院              | icd10_code            |
| H    | 就诊/入院日期         | age                   |
| I    | 住院号                | discharge_department  |
| J    | 就诊/入院科室         | inhospital_length     |
| K    | 主诊断ICD10名称       | is_icu_transfer       |
| L    | 主诊断ICD10编码       | ❌ 删除                |
| M    | 就诊年龄(岁)          | ❌ 删除                |
| N    | 出院科室              | ❌ 删除                |
| O    | 住院天数              | ❌ 删除                |
| P    | 是否转入ICU           | ❌ 删除                |

---

### 入院记录.csv（11 → 6）

| 序号 | 原来的列名            | 现在的列名           |
| ---- | --------------------- | -------------------- |
| A    | patient_sn            | admission_key        |
| B    | 分组名称              | vsn_admission_record |
| C    | test_性别_时间段1     | admission_time       |
| D    | test_出生日期_时间段1 | pre_disease_name     |
| E    | test_是否死亡_时间段1 | is_smoking           |
| F    | 时间段                | is_drinking          |
| G    | vsn_入院记录          | ❌ 删除               |
| H    | 入院时间              | ❌ 删除               |
| I    | 既往疾病名称          | ❌ 删除               |
| J    | 是否吸烟              | ❌ 删除               |
| K    | 是否饮酒              | ❌ 删除               |

---

### 其他检验.csv（9 → 7）

| 序号 | 原来的列名         | 现在的列名         |
| ---- | ------------------ | ------------------ |
| A    | patient_sn         | admission_key      |
| B    | 分组名称           | vsn_lab_other      |
| C    | 时间段             | test_time          |
| D    | vsn_其他检验       | pure_item_name     |
| E    | 检验日期           | item_name          |
| F    | 检验项目名称(原值) | qualitative_result |
| G    | 检验项目名称(归一) | test_result        |
| H    | 检验定性结果       | ❌ 删除             |
| I    | 检验定量结果       | ❌ 删除             |

---

### 生化.csv（9 → 7）

| 序号 | 原来的列名         | 现在的列名                |
| ---- | ------------------ | ------------------------- |
| A    | patient_sn         | admission_key             |
| B    | 分组名称           | vsn_lab_biochemical_tests |
| C    | 时间段             | test_time                 |
| D    | vsn_生化检查       | pure_item_name            |
| E    | 检验日期           | item_name                 |
| F    | 检验项目名称(原值) | qualitative_result        |
| G    | 检验项目名称(归一) | test_result               |
| H    | 检验定性结果       | ❌ 删除                    |
| I    | 检验定量结果       | ❌ 删除                    |

---

### 生命体征.csv（16 → 11）

| 序号 | 原来的列名            | 现在的列名         |
| ---- | --------------------- | ------------------ |
| A    | patient_sn            | admission_key      |
| B    | 分组名称              | vsn_vital_sign     |
| C    | test_性别_时间段1     | temperature        |
| D    | test_出生日期_时间段1 | pulse              |
| E    | test_是否死亡_时间段1 | heart_rate         |
| F    | 时间段                | respiratory_rate   |
| G    | vsn_生命体征          | diastolic_pressure |
| H    | 体温(摄氏度)          | systolic_pressure  |
| I    | 脉搏(次/分)           | height             |
| J    | 心率(次/分)           | weight             |
| K    | 呼吸频率(次/分)       | body_mass_index    |
| L    | 舒张压(mmHg)          | ❌ 删除             |
| M    | 收缩压(mmHg)          | ❌ 删除             |
| N    | 身高(cm)              | ❌ 删除             |
| O    | 体重(kg)              | ❌ 删除             |
| P    | 体重指数(BMI)         | ❌ 删除             |

---

### 糖代谢.csv（12 → 7）

| 序号 | 原来的列名                                       | 现在的列名                      |
| ---- | ------------------------------------------------ | ------------------------------- |
| A    | patient_sn                                       | admission_key                   |
| B    | 分组名称                                         | vsn_lab_glucose_metabolism_test |
| C    | test_性别_时间段1                                | HbA1c_test_time                 |
| D    | test_出生日期_时间段1                            | HbA1c_pure_item_name            |
| E    | test_是否死亡_时间段1                            | HbA1c_item_name                 |
| F    | 时间段                                           | HbA1c_qualitative_result        |
| G    | vsn_糖代谢测定                                   | HbA1c_test_result               |
| H    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验日期           | ❌ 删除                          |
| I    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验项目名称(原值) | ❌ 删除                          |
| J    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验项目名称(归一) | ❌ 删除                          |
| K    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验定性结果       | ❌ 删除                          |
| L    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验定量结果       | ❌ 删除                          |

---

### 药品医嘱.csv（27 → 22）

| 序号 | 原来的列名            | 现在的列名                 |
| ---- | --------------------- | -------------------------- |
| A    | patient_sn            | admission_key              |
| B    | 分组名称              | vsn_medicinal_order        |
| C    | 时间段                | prescribed_time            |
| D    | vsn_药品类医嘱        | start_time                 |
| E    | 开立时间              | stop_time                  |
| F    | 开始时间              | order_group_no             |
| G    | 结束时间              | trade_name                 |
| H    | 同组标识              | common_name                |
| I    | 药物商品名            | inn_name                   |
| J    | 药物通用名            | class_name                 |
| K    | 药物成分名            | dosage_form                |
| L    | 药物类别              | spec                       |
| M    | 药物剂型              | drug_dosage_per_use        |
| N    | 药物规格              | drug_dosage_per_use_unit   |
| O    | 单次剂量              | drug_frequency             |
| P    | 单次剂量单位          | drug_administration_method |
| Q    | 用药频次              | patient_instruction        |
| R    | 给药途径              | total_dosage               |
| S    | 嘱托                  | total_dosage_unit          |
| T    | 使用总量              | long_term_or_temporary     |
| U    | 使用总量单位          | order_status               |
| V    | 长期/临时/出院带药    | source_table               |
| W    | 医嘱状态              | ❌ 删除                     |
| X    | 医嘱来源              | ❌ 删除                     |
| Y    | test_性别_时间段1     | ❌ 删除                     |
| Z    | test_出生日期_时间段1 | ❌ 删除                     |
| AA   | test_是否死亡_时间段1 | ❌ 删除                     |

---

### 血常规.csv（9 → 7）

| 序号 | 原来的列名         | 现在的列名                        |
| ---- | ------------------ | --------------------------------- |
| A    | patient_sn         | admission_key                     |
| B    | 分组名称           | vsn_lab_blood_routine_examination |
| C    | 时间段             | test_time                         |
| D    | vsn_血常规         | pure_item_name                    |
| E    | 检验日期           | item_name                         |
| F    | 检验项目名称(原值) | qualitative_result                |
| G    | 检验项目名称(归一) | test_result                       |
| H    | 检验定性结果       | ❌ 删除                            |
| I    | 检验定量结果       | ❌ 删除                            |

---

### 血糖.csv（10 → 5）

| 序号 | 原来的列名            | 现在的列名     |
| ---- | --------------------- | -------------- |
| A    | patient_sn            | admission_key  |
| B    | 分组名称              | vsn_glu_record |
| C    | test_性别_时间段1     | exam_time      |
| D    | test_出生日期_时间段1 | blood_sugar    |
| E    | test_是否死亡_时间段1 | blood_ketone   |
| F    | 时间段                | ❌ 删除         |
| G    | vsn_血糖单            | ❌ 删除         |
| H    | 采集时间              | ❌ 删除         |
| I    | 血糖(mmol/l)          | ❌ 删除         |
| J    | 血酮(mmol/l)          | ❌ 删除         |

---

### 诊断.csv（5 → 3）

| 序号 | 原来的列名   | 现在的列名    |
| ---- | ------------ | ------------- |
| A    | patient_sn   | admission_key |
| B    | 分组名称     | vsn_diagnosis |
| C    | 时间段       | disease_name  |
| D    | vsn_全部诊断 | ❌ 删除        |
| E    | 诊断名称     | ❌ 删除        |

---

### 非药品医嘱.csv（15 → 13）

| 序号 | 原来的列名       | 现在的列名             |
| ---- | ---------------- | ---------------------- |
| A    | patient_sn       | admission_key          |
| B    | 分组名称         | vsn_non_drug_order     |
| C    | 时间段           | prescribed_time        |
| D    | vsn_非药品类医嘱 | start_time             |
| E    | 开立时间         | stop_time              |
| F    | 开始时间         | order_type             |
| G    | 结束时间         | order_item_name        |
| H    | 医嘱项目类型     | quantity               |
| I    | 医嘱项目内容     | quantity_unit          |
| J    | 医嘱数量         | long_term_or_temporary |
| K    | 数量单位         | frequency              |
| L    | 长期或临时       | order_status           |
| M    | 频次             | visit_type             |
| N    | 医嘱状态         | ❌ 删除                 |
| O    | 就诊类型         | ❌ 删除                 |

## HYPO 组 原列名 → 现列名（按 A/B/C…）

HYPO 的「原列名」与 Health 基本一致，仅性别/出生日期/死亡列前缀为 `低血糖_`，部分表列数略不同（生化、血常规、药品医嘱、非药品医嘱 多列）。

### CRP.csv（22 → 17）

| 序号 | 原来的列名                                            | 现在的列名                         |
| ---- | ----------------------------------------------------- | ---------------------------------- |
| A    | patient_sn                                            | admission_key                      |
| B    | 分组名称                                              | vsn_lab_crp_tests                  |
| C    | 低血糖_性别_时间段1                                   | CRP_test_time                      |
| D    | 低血糖_出生日期_时间段1                               | CRP_pure_item_name                 |
| E    | 低血糖_是否死亡_时间段1                               | CRP_item_name                      |
| F    | 时间段                                                | CRP_qualitative_result             |
| G    | vsn_C反应蛋白检测                                     | CRP_test_result                    |
| H    | C-反应蛋白(CRP)-静脉血_检验日期                       | hs-CRP_test_time                   |
| I    | C-反应蛋白(CRP)-静脉血_检验项目名称(原值)             | hs-CRP_pure_item_name              |
| J    | C-反应蛋白(CRP)-静脉血_检验项目名称(归一)             | hs-CRP_item_name                   |
| K    | C-反应蛋白(CRP)-静脉血_检验定性结果                   | hs-CRP_qualitative_result          |
| L    | C-反应蛋白(CRP)-静脉血_检验定量结果                   | hs-CRP_test_result                 |
| M    | 超敏C反应蛋白(hs-CRP)-静脉血_检验日期                 | hs-CRP_test_time.1                 |
| N    | 超敏C反应蛋白(hs-CRP)-静脉血_检验项目名称(原值)       | hs-CRP)-静脉血(空腹_pure_item_name |
| O    | 超敏C反应蛋白(hs-CRP)-静脉血_检验项目名称(归一)       | hs-CRP)-静脉血(空腹_item_name      |
| P    | 超敏C反应蛋白(hs-CRP)-静脉血_检验定性结果             | hs-CRP_qualitative_result.1        |
| Q    | 超敏C反应蛋白(hs-CRP)-静脉血_检验定量结果             | hs-CRP_test_result.1               |
| R    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验日期           | ❌ 删除                             |
| S    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验项目名称(原值) | ❌ 删除                             |
| T    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验项目名称(归一) | ❌ 删除                             |
| U    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验定性结果       | ❌ 删除                             |
| V    | 超敏C反应蛋白(hs-CRP)-静脉血(空腹)_检验定量结果       | ❌ 删除                             |

---

### 住院.csv（16 → 11）

| 序号 | 原来的列名              | 现在的列名            |
| ---- | ----------------------- | --------------------- |
| A    | patient_sn              | admission_key         |
| B    | 分组名称                | vsn_first_page_record |
| C    | 低血糖_性别_时间段1     | visit_date            |
| D    | 低血糖_出生日期_时间段1 | inpatient_no          |
| E    | 低血糖_是否死亡_时间段1 | visit_department      |
| F    | 时间段                  | icd10_name            |
| G    | vsn_住院                | icd10_code            |
| H    | 就诊/入院日期           | age                   |
| I    | 住院号                  | discharge_department  |
| J    | 就诊/入院科室           | inhospital_length     |
| K    | 主诊断ICD10名称         | is_icu_transfer       |
| L    | 主诊断ICD10编码         | ❌ 删除                |
| M    | 就诊年龄(岁)            | ❌ 删除                |
| N    | 出院科室                | ❌ 删除                |
| O    | 住院天数                | ❌ 删除                |
| P    | 是否转入ICU             | ❌ 删除                |

---

### 入院记录.csv（11 → 6）

| 序号 | 原来的列名              | 现在的列名           |
| ---- | ----------------------- | -------------------- |
| A    | patient_sn              | admission_key        |
| B    | 分组名称                | vsn_admission_record |
| C    | 低血糖_性别_时间段1     | admission_time       |
| D    | 低血糖_出生日期_时间段1 | pre_disease_name     |
| E    | 低血糖_是否死亡_时间段1 | is_smoking           |
| F    | 时间段                  | is_drinking          |
| G    | vsn_入院记录            | ❌ 删除               |
| H    | 入院时间                | ❌ 删除               |
| I    | 既往疾病名称            | ❌ 删除               |
| J    | 是否吸烟                | ❌ 删除               |
| K    | 是否饮酒                | ❌ 删除               |

---

### 其他检验.csv（9 → 7）

| 序号 | 原来的列名         | 现在的列名         |
| ---- | ------------------ | ------------------ |
| A    | patient_sn         | admission_key      |
| B    | 分组名称           | vsn_lab_other      |
| C    | 时间段             | test_time          |
| D    | vsn_其他检验       | pure_item_name     |
| E    | 检验日期           | item_name          |
| F    | 检验项目名称(原值) | qualitative_result |
| G    | 检验项目名称(归一) | test_result        |
| H    | 检验定性结果       | ❌ 删除             |
| I    | 检验定量结果       | ❌ 删除             |

---

### 生化.csv（12 → 7）

| 序号 | 原来的列名              | 现在的列名                |
| ---- | ----------------------- | ------------------------- |
| A    | patient_sn              | admission_key             |
| B    | 分组名称                | vsn_lab_biochemical_tests |
| C    | 低血糖_性别_时间段1     | test_time                 |
| D    | 低血糖_出生日期_时间段1 | pure_item_name            |
| E    | 低血糖_是否死亡_时间段1 | item_name                 |
| F    | 时间段                  | qualitative_result        |
| G    | vsn_生化检查            | test_result               |
| H    | 检验日期                | ❌ 删除                    |
| I    | 检验项目名称(原值)      | ❌ 删除                    |
| J    | 检验项目名称(归一)      | ❌ 删除                    |
| K    | 检验定性结果            | ❌ 删除                    |
| L    | 检验定量结果            | ❌ 删除                    |

---

### 生命体征.csv（16 → 11）

| 序号 | 原来的列名              | 现在的列名         |
| ---- | ----------------------- | ------------------ |
| A    | patient_sn              | admission_key      |
| B    | 分组名称                | vsn_vital_sign     |
| C    | 低血糖_性别_时间段1     | temperature        |
| D    | 低血糖_出生日期_时间段1 | pulse              |
| E    | 低血糖_是否死亡_时间段1 | heart_rate         |
| F    | 时间段                  | respiratory_rate   |
| G    | vsn_生命体征            | diastolic_pressure |
| H    | 体温(摄氏度)            | systolic_pressure  |
| I    | 脉搏(次/分)             | height             |
| J    | 心率(次/分)             | weight             |
| K    | 呼吸频率(次/分)         | body_mass_index    |
| L    | 舒张压(mmHg)            | ❌ 删除             |
| M    | 收缩压(mmHg)            | ❌ 删除             |
| N    | 身高(cm)                | ❌ 删除             |
| O    | 体重(kg)                | ❌ 删除             |
| P    | 体重指数(BMI)           | ❌ 删除             |

---

### 糖代谢.csv（12 → 7）

| 序号 | 原来的列名                                       | 现在的列名                      |
| ---- | ------------------------------------------------ | ------------------------------- |
| A    | patient_sn                                       | admission_key                   |
| B    | 分组名称                                         | vsn_lab_glucose_metabolism_test |
| C    | 低血糖_性别_时间段1                              | HbA1c_test_time                 |
| D    | 低血糖_出生日期_时间段1                          | HbA1c_pure_item_name            |
| E    | 低血糖_是否死亡_时间段1                          | HbA1c_item_name                 |
| F    | 时间段                                           | HbA1c_qualitative_result        |
| G    | vsn_糖代谢测定                                   | HbA1c_test_result               |
| H    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验日期           | ❌ 删除                          |
| I    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验项目名称(原值) | ❌ 删除                          |
| J    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验项目名称(归一) | ❌ 删除                          |
| K    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验定性结果       | ❌ 删除                          |
| L    | 糖化血红蛋白A1c(HbA1c)-静脉血_检验定量结果       | ❌ 删除                          |

---

### 药品医嘱.csv（26 → 21）

| 序号 | 原来的列名              | 现在的列名                 |
| ---- | ----------------------- | -------------------------- |
| A    | patient_sn              | admission_key              |
| B    | 分组名称                | vsn_medicinal_order        |
| C    | 时间段                  | prescribed_time            |
| D    | vsn_药品类医嘱          | start_time                 |
| E    | 开立时间                | stop_time                  |
| F    | 开始时间                | order_group_no             |
| G    | 结束时间                | trade_name                 |
| H    | 同组标识                | common_name                |
| I    | 药物商品名              | inn_name                   |
| J    | 药物通用名              | class_name                 |
| K    | 药物成分名              | dosage_form                |
| L    | 药物类别                | spec                       |
| M    | 药物剂型                | drug_dosage_per_use        |
| N    | 药物规格                | drug_dosage_per_use_unit   |
| O    | 单次剂量                | drug_frequency             |
| P    | 单次剂量单位            | drug_administration_method |
| Q    | 用药频次                | patient_instruction        |
| R    | 给药途径                | long_term_or_temporary     |
| S    | 嘱托                    | order_status               |
| T    | 长期/临时/出院带药      | total_dosage               |
| U    | 医嘱状态                | total_dosage_unit          |
| V    | 低血糖_性别_时间段1     | ❌ 删除                     |
| W    | 低血糖_出生日期_时间段1 | ❌ 删除                     |
| X    | 低血糖_是否死亡_时间段1 | ❌ 删除                     |
| Y    | 使用总量                | ❌ 删除                     |
| Z    | 使用总量单位            | ❌ 删除                     |

---

### 血常规.csv（12 → 7）

| 序号 | 原来的列名              | 现在的列名                        |
| ---- | ----------------------- | --------------------------------- |
| A    | patient_sn              | admission_key                     |
| B    | 分组名称                | vsn_lab_blood_routine_examination |
| C    | 低血糖_性别_时间段1     | test_time                         |
| D    | 低血糖_出生日期_时间段1 | pure_item_name                    |
| E    | 低血糖_是否死亡_时间段1 | item_name                         |
| F    | 时间段                  | qualitative_result                |
| G    | vsn_血常规              | test_result                       |
| H    | 检验日期                | ❌ 删除                            |
| I    | 检验项目名称(原值)      | ❌ 删除                            |
| J    | 检验项目名称(归一)      | ❌ 删除                            |
| K    | 检验定性结果            | ❌ 删除                            |
| L    | 检验定量结果            | ❌ 删除                            |

---

### 血糖.csv（10 → 5）

| 序号 | 原来的列名              | 现在的列名     |
| ---- | ----------------------- | -------------- |
| A    | patient_sn              | admission_key  |
| B    | 分组名称                | vsn_glu_record |
| C    | 低血糖_性别_时间段1     | exam_time      |
| D    | 低血糖_出生日期_时间段1 | blood_sugar    |
| E    | 低血糖_是否死亡_时间段1 | blood_ketone   |
| F    | 时间段                  | ❌ 删除         |
| G    | vsn_血糖单              | ❌ 删除         |
| H    | 采集时间                | ❌ 删除         |
| I    | 血糖(mmol/l)            | ❌ 删除         |
| J    | 血酮(mmol/l)            | ❌ 删除         |

---

### 诊断.csv（5 → 3）

| 序号 | 原来的列名   | 现在的列名    |
| ---- | ------------ | ------------- |
| A    | patient_sn   | admission_key |
| B    | 分组名称     | vsn_diagnosis |
| C    | 时间段       | disease_name  |
| D    | vsn_全部诊断 | ❌ 删除        |
| E    | 诊断名称     | ❌ 删除        |

---

### 非药品医嘱.csv（16 → 14）

| 序号 | 原来的列名       | 现在的列名                 |
| ---- | ---------------- | -------------------------- |
| A    | patient_sn       | admission_key              |
| B    | 分组名称         | vsn_non_drug_order         |
| C    | 时间段           | prescribed_time            |
| D    | vsn_非药品类医嘱 | start_time                 |
| E    | 开立时间         | stop_time                  |
| F    | 开始时间         | order_type                 |
| G    | 结束时间         | order_item_name            |
| H    | 医嘱项目类型     | quantity                   |
| I    | 医嘱项目内容     | quantity_unit              |
| J    | 医嘱数量         | long_term_or_temporary     |
| K    | 数量单位         | frequency                  |
| L    | 长期或临时       | order_status               |
| M    | 频次             | visit_type                 |
| N    | 医嘱状态         | prescribed_department_name |
| O    | 就诊类型         | ❌ 删除                     |
| P    | 开立科室         | ❌ 删除                     |

|      |      |      |
| ---- | ---- | ---- |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
|      |      |      |
